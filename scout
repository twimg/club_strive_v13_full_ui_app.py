import streamlit as st
import pandas as pd

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ï¼ˆCSVï¼‰
df = pd.read_csv("players.csv")

st.title("ğŸ” ã‚¹ã‚«ã‚¦ãƒˆæ¤œç´¢")

# --- æ¤œç´¢æ¡ä»¶ã®UI ---
col1, col2, col3 = st.columns(3)
with col1:
    position = st.selectbox("ãƒã‚¸ã‚·ãƒ§ãƒ³", ["å…¨ã¦"] + sorted(df["ãƒã‚¸ã‚·ãƒ§ãƒ³"].unique()))
with col2:
    free_status = st.selectbox("ãƒ•ãƒªãƒ¼é¸æ‰‹ã®ã¿", ["å…¨ã¦", "ãƒ•ãƒªãƒ¼"])
with col3:
    max_contract_years = st.slider("å¥‘ç´„æ®‹å¹´æ•°ï¼ˆä»¥ä¸‹ï¼‰", 0, 5, 5)

col4, col5 = st.columns(2)
with col4:
    min_loyalty = st.slider("å¿ èª å¿ƒï¼ˆä»¥ä¸Šï¼‰", 0, 100, 0)
with col5:
    max_transfer_wish = st.slider("ç§»ç±å¸Œæœ›åº¦ï¼ˆä»¥ä¸‹ï¼‰", 0, 100, 100)

# --- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å‡¦ç† ---
filtered_df = df.copy()
if position != "å…¨ã¦":
    filtered_df = filtered_df[filtered_df["ãƒã‚¸ã‚·ãƒ§ãƒ³"] == position]
if free_status == "ãƒ•ãƒªãƒ¼":
    filtered_df = filtered_df[filtered_df["å¥‘ç´„çŠ¶æ…‹"] == "ãƒ•ãƒªãƒ¼"]
filtered_df = filtered_df[filtered_df["å¥‘ç´„æ®‹å¹´æ•°"] <= max_contract_years]
filtered_df = filtered_df[filtered_df["å¿ èª å¿ƒ"] >= min_loyalty]
filtered_df = filtered_df[filtered_df["ç§»ç±å¸Œæœ›åº¦"] <= max_transfer_wish]

# --- è¡¨ç¤º ---
st.write(f"ğŸ” è©²å½“é¸æ‰‹ï¼š{len(filtered_df)}å")
st.dataframe(filtered_df)

# --- CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ ---
csv = filtered_df.to_csv(index=False).encode('utf-8')
st.download_button("ğŸ“¥ CSVãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰", csv, "scouted_players.csv", "text/csv")
